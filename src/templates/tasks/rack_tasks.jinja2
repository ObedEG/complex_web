{% extends "base.jinja2" %}
{% block content %}
<div class="row">
          <div class="col-lg-12">
            <div class="page-header">
              <h3>Rack Test Report</h3>
            </div>

            <div class="bs-component">

            </div>

            <div class="bs-component">
                  <table class="table table-striped table-hover ">
                <thead>
                  <tr class="warning">
                      <th><h4>TASK</h4></th>
                    <th><h4>CATEGORY</h4></th>
                    <th><h4>DESCRIPTION</h4></th>
                    <th><h4>STATUS</h4></th>
                    <th></th>
                    <th></th>
                  </tr>
                </thead>
        {% for task in tasks %}
                 <!---class="list-group-item"> -->
                    <tr class=" transbox {% if task.status == 'Debugging' -%} danger {% elif task.status == 'Finished' -%} success {% elif task.status == 'Running' -%} info {% else -%} active {%- endif %}">

                        <td><h4><span class="glyphicon glyphicon-menu-right"></span>{{ tasks.index(task)+1 }}</h4></td>
                        <td><h4>{{ task.category }}</h4></td>
                        <td><h4>{{ task.description }}</h4></td>
                        <td><h4>{{ task.status }}</h4></td>
                        <td><p class="bs-component">
                            <a href="{{ url_for('tasks.passed', task=task._id) }}" class="btn btn-success {% if task.status != 'Running' -%} disabled {%- endif %}">PASSED</a>
                        </p></td>
                        <td><p class="bs-component">
                            <a href="{{ url_for('failures.report', rack=task.rack, task=task._id) }}" class="btn btn-danger  {% if task.status != 'Running' -%} disabled {%- endif %}">FAILED</a>
                        </p></td>
                    </tr>
                    {% if task.status == 'Debugging' -%}
                    <tr class=" transbox {% if task.status == 'Debugging' -%} danger {% elif task.status == 'Finished' -%} success {% elif task.status == 'Running' -%} info {% else -%} active {%- endif %}">
                        <td></td>
                        <td></td>
                        <td>FAILURE: {{ get_failure(task.failure).description }}</td>
                        <td>{% if get_failure(task.failure).fixes == [] -%}<p class="bs-component">
                            <a href="{{ url_for('fixes.add_new_fix', rack=task.rack, task=task._id, failure=task.failure) }}" class="btn btn-warning">Add FIX</a>
                            {%- endif %}
                        </p></td>
                        <td></td>
                        <td></td>
                    </tr>

                  {% for fixid in get_failure(task.failure).fixes %}
                    <tr class=" transbox {% if task.status == 'Debugging' -%} danger {% elif task.status == 'Finished' -%} success {% elif task.status == 'Running' -%} info {% else -%} active {%- endif %}">
                        <td></td>
                        <td></td>
                        <td><h4>FIX {{get_failure(task.failure).fixes.index(fixid)+1}}</h4> {{ get_fix(fixid).description }}<br>
                            {{ fixid }}
                        </td>
                        <td>{% if get_fix(fixid).feedback != '' %} Feedback: {{ get_fix(fixid).feedback }} {% endif %}</td>
                        <td><p class="bs-component">
                            <a href="{{ url_for('fixes.passed', fix=fixid) }}" class="btn btn-success {% if get_fix(fixid).feedback != '' -%} disabled {%- endif %}">PASSED</a>
                        </p></td>
                        <td><p class="bs-component">
                            <a href="{{ url_for('fixes.feedback', fix=fixid) }}" class="btn btn-danger  {% if get_fix(fixid).feedback != '' -%} disabled {%- endif %}">FAILED</a>
                        </p></td>
                    </tr>

                  {% endfor %}

                    {%- endif %}

        {% endfor %}
                </tbody>
                </table>
            <div id="source-button" class="btn btn-primary btn-xs" style="display: none;">&lt; &gt;</div>
            </div><!-- /example -->
          </div>
</div>
{% endblock %}